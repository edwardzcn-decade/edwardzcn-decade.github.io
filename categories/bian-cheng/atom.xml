<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
    <title>🌟Edwardzcn blog - 编程</title>
    <subtitle>Promised land</subtitle>
    <link rel="self" type="application/atom+xml" href="https://www.edwardzcn.me/categories/bian-cheng/atom.xml"/>
    <link rel="alternate" type="text/html" href="https://www.edwardzcn.me"/>
    <generator uri="https://www.getzola.org/">Zola</generator>
    <updated>2025-10-21T00:00:00+00:00</updated>
    <id>https://www.edwardzcn.me/categories/bian-cheng/atom.xml</id>
    <entry xml:lang="en">
        <title>Linux与macOS软件包验证公钥管理方式</title>
        <published>2025-10-21T00:00:00+00:00</published>
        <updated>2025-10-21T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              edwardzcn-decade
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://www.edwardzcn.me/blog/programming/keyring-management-linux-macos/"/>
        <id>https://www.edwardzcn.me/blog/programming/keyring-management-linux-macos/</id>
        
        <content type="html" xml:base="https://www.edwardzcn.me/blog/programming/keyring-management-linux-macos/">&lt;h2 id=&quot;qian-ming-ruan-jian-bao-yu-yan-zheng-gong-yao&quot;&gt;签名软件包与验证公钥&lt;&#x2F;h2&gt;
&lt;p&gt;接触过服务器的朋友对 &lt;code&gt;yum&lt;&#x2F;code&gt;、&lt;code&gt;rpm&lt;&#x2F;code&gt;、&lt;code&gt;apt&lt;&#x2F;code&gt;、&lt;code&gt;apt-get&lt;&#x2F;code&gt; 这些指令应该不陌生，它们属于不同 Linux 发行版的软件包管理系统（Package Management System, PMS），其历史可以追溯到上世纪 90 年代。现代操作系统中，我们常通过软件包管理器来安装或更新软件——服务器系统尤为常见，桌面系统如 macOS 的 &lt;code&gt;brew&lt;&#x2F;code&gt; 也是同类工具。软件包管理器通过从远程仓库拉取并下载，与当前系统匹配的预编译的软件包，简化安装和更新过程。&lt;&#x2F;p&gt;
&lt;p&gt;在安全层面，软件包管理器依赖数字签名技术来确保软件包的完整性和来源可信。开发者会使用自己的私钥为发布的软件包签名，而用户系统则使用开发者提供的公钥来验证下载的完整性（确保软件包完整且未被篡改或伪造）。这一过程可以由软件包管理器自动完成，也可以手动执行。例如，在基于 RPM 的系统上可以使用 &lt;code&gt;rpm --checksig package.rpm&lt;&#x2F;code&gt; 来验证签名。比如在一个centOS7服务器检测手动下载的&lt;code&gt;openssl&lt;&#x2F;code&gt;包：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;rpm --checksig&lt;&#x2F;span&gt;&lt;span&gt; openssl-1.0.2k-25.el7_9.x86_64.rpm
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;openssl-1.0.2k-25.el7_9.x86_64.rpm:&lt;&#x2F;span&gt;&lt;span&gt; rsa sha1 (md5) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;pgp&lt;&#x2F;span&gt;&lt;span&gt; md5 OK
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;gpg&quot;&gt;GPG&lt;&#x2F;h3&gt;
&lt;p&gt;GPG 是 GNU Privacy Guard 的缩写，也称 GnuPG，是一个免费软件，用于确保分发文件的真实性。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;ge-xi-tong-de-mi-yao-guan-li-fang-shi&quot;&gt;各系统的密钥管理方式&lt;&#x2F;h2&gt;
&lt;h3 id=&quot;debian-ubuntu-xi-tong&quot;&gt;Debian&#x2F;Ubuntu 系统&lt;&#x2F;h3&gt;
&lt;h4 id=&quot;zao-qi-de-apt-key-yi-qi-yong&quot;&gt;早期的&lt;code&gt;apt-key&lt;&#x2F;code&gt;（已弃用）&lt;&#x2F;h4&gt;
&lt;p&gt;在较早的 Debian 和 Ubuntu系统中，&lt;code&gt;apt-key&lt;&#x2F;code&gt; 工具被用来管理软件包验证公钥。用户可以通过 &lt;code&gt;apt-key add filename&lt;&#x2F;code&gt; 命令将公钥添加到系统中，通过该工具添加密钥默认被存储在 &lt;code&gt;&#x2F;etc&#x2F;apt&#x2F;trusted.gpg&lt;&#x2F;code&gt; 文件中。&lt;code&gt;apt-key list&lt;&#x2F;code&gt; 则用于列出已添加的公钥。该命令默认会显示所有存储在 &lt;code&gt;&#x2F;etc&#x2F;apt&#x2F;trusted.gpg&lt;&#x2F;code&gt; 以及 &lt;code&gt;&#x2F;etc&#x2F;apt&#x2F;trusted.gpg.d&#x2F;&lt;&#x2F;code&gt; 目录下的密钥。&lt;&#x2F;p&gt;
&lt;p&gt;通过&lt;code&gt;man apt-key&lt;&#x2F;code&gt;可以看到：&lt;&#x2F;p&gt;
&lt;blockquote&gt;
&lt;p&gt;apt-key(8) will last be available in Debian 12 and Ubuntu 24.04.&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;p&gt;在Debian 12和 Ubuntu 24.04之后，&lt;code&gt;apt-key&lt;&#x2F;code&gt; 将被完全弃用，我的系统是Ubuntu 24.04 所以还可以使用&lt;code&gt;list&lt;&#x2F;code&gt;指令，同时检查到&lt;code&gt;trusted.gpg.bak&lt;&#x2F;code&gt;文件备份，可以测试&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;apt-key&lt;&#x2F;span&gt;&lt;span&gt; list&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --keyring&lt;&#x2F;span&gt;&lt;span&gt; &#x2F;etc&#x2F;apt&#x2F;trusted.gpg.bak
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;该工具将遍历&lt;code&gt;&#x2F;etc&#x2F;apt&#x2F;trusted.gpg.d&#x2F;&lt;&#x2F;code&gt;目录下的每个文件，将其中的公钥与备份的公钥二进制文件合并显示。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;txt&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-txt &quot;&gt;&lt;code class=&quot;language-txt&quot; data-lang=&quot;txt&quot;&gt;&lt;span&gt;&#x2F;etc&#x2F;apt&#x2F;trusted.gpg.d&#x2F;syncthing.gpg
&lt;&#x2F;span&gt;&lt;span&gt;------------------------------------
&lt;&#x2F;span&gt;&lt;span&gt;pub   rsa4096 2024-11-24 [SC]
&lt;&#x2F;span&gt;&lt;span&gt;      FBA2 E162 F2F4 4657 B38F  0309 E566 5F9B D597 0C47
&lt;&#x2F;span&gt;&lt;span&gt;uid           [ unknown] Syncthing Release Management &amp;lt;release@syncthing.net&amp;gt;
&lt;&#x2F;span&gt;&lt;span&gt;sub   rsa4096 2024-11-24 [E]
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;&#x2F;etc&#x2F;apt&#x2F;trusted.gpg.bak
&lt;&#x2F;span&gt;&lt;span&gt;------------------------
&lt;&#x2F;span&gt;&lt;span&gt;pub   rsa4096 2024-11-24 [SC]
&lt;&#x2F;span&gt;&lt;span&gt;      FBA2 E162 F2F4 4657 B38F  0309 E566 5F9B D597 0C47
&lt;&#x2F;span&gt;&lt;span&gt;uid           [ unknown] Syncthing Release Management &amp;lt;release@syncthing.net&amp;gt;
&lt;&#x2F;span&gt;&lt;span&gt;sub   rsa4096 2024-11-24 [E]
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;pub   rsa4096 2015-03-16 [SC]
&lt;&#x2F;span&gt;&lt;span&gt;      DF00 FAF1 C577 104B 50BF  1D00 93D6 889F 9F0E 78D5
&lt;&#x2F;span&gt;&lt;span&gt;uid           [ unknown] Igor Pecovnik &amp;lt;igor@armbian.com&amp;gt;
&lt;&#x2F;span&gt;&lt;span&gt;uid           [ unknown] Igor Pecovnik (Ljubljana, Slovenia) &amp;lt;igor.pecovnik@gmail.com&amp;gt;
&lt;&#x2F;span&gt;&lt;span&gt;sub   rsa4096 2015-03-16 [E]
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h4 id=&quot;zhi-biao-bu-zhi-ben-shou-xin-ren-de-gong-yao-lie-biao-bu-tui-jian&quot;&gt;治标不治本：受信任的公钥列表（不推荐）&lt;&#x2F;h4&gt;
&lt;p&gt;一种改良方法是将手动编辑&lt;code&gt;&#x2F;etc&#x2F;apt&#x2F;trusted.gpg.d&#x2F;&lt;&#x2F;code&gt;目录下的文件，增加&lt;code&gt;.asc&lt;&#x2F;code&gt;或&lt;code&gt;.gpg&lt;&#x2F;code&gt;格式的公钥文件，文件名提供公钥用途的解释。参考&lt;code&gt;apt-key&lt;&#x2F;code&gt; 工具中的建议：&lt;&#x2F;p&gt;
&lt;blockquote&gt;
&lt;p&gt;add filename (deprecated)&lt;&#x2F;p&gt;
&lt;p&gt;...&lt;&#x2F;p&gt;
&lt;p&gt;Note: Instead of using this command a keyring should be placed directly in the &#x2F;etc&#x2F;apt&#x2F;trusted.gpg.d&#x2F; directory with a descriptive name and either &quot;gpg&quot; or &quot;asc&quot; as file extension&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;p&gt;但这种方法实际上只是对原来单一文件进行了拆分，并不安全。在该目录下的公钥文件都会被所有仓库信赖，参考 &lt;a href=&quot;https:&#x2F;&#x2F;www.linuxuprising.com&#x2F;2021&#x2F;01&#x2F;apt-key-is-deprecated-how-to-add.html&quot;&gt;stark overflow上的讨论&lt;&#x2F;a&gt;&lt;sup class=&quot;footnote-reference&quot; id=&quot;fr-1-1&quot;&gt;&lt;a href=&quot;#fn-1&quot;&gt;[1]&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;。&lt;&#x2F;p&gt;
&lt;h4 id=&quot;tui-jian-de-xi-li-du-gong-yao-guan-li-fang-shi&quot;&gt;推荐的细粒度公钥管理方式&lt;&#x2F;h4&gt;
&lt;p&gt;上述公钥列表方案也即将被废弃，apt (2.9.24) &lt;a href=&quot;https:&#x2F;&#x2F;salsa.debian.org&#x2F;apt-team&#x2F;apt&#x2F;-&#x2F;raw&#x2F;2.9.24&#x2F;debian&#x2F;NEWS&quot;&gt;更新报告&lt;&#x2F;a&gt;表示不再将该公钥列表认定为安全的配置方式&lt;sup class=&quot;footnote-reference&quot; id=&quot;fr-2-1&quot;&gt;&lt;a href=&quot;#fn-2&quot;&gt;[2]&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;：&lt;&#x2F;p&gt;
&lt;blockquote&gt;
&lt;p&gt;apt (2.9.24) unstable; urgency=medium&lt;&#x2F;p&gt;
&lt;p&gt;&#x2F;etc&#x2F;apt&#x2F;trusted.gpg is no longer trusted. Setting the Dir::Etc::trusted option manually continues to work for some more time.&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;p&gt;Debian 和 Ubuntu 推荐将每个仓库的公钥存储在仅root可写的目录下，比如 &lt;code&gt;&#x2F;usr&#x2F;share&#x2F;keyrings&#x2F;&lt;&#x2F;code&gt;，并在仓库源（&lt;code&gt;&#x2F;etc&#x2F;apt&#x2F;sources.list&lt;&#x2F;code&gt;和&lt;code&gt;&#x2F;etc&#x2F;apt&#x2F;sources.list.d&#x2F;&lt;&#x2F;code&gt; 目录）通过 &lt;code&gt;signed-by&lt;&#x2F;code&gt; 参数指定对应的公钥文件。相较于先前较为粗暴的单一白名单文件，这种细粒度的管理方式，让每个仓库公钥可以独立管理，避免公钥信任扩展，同时提高配置的灵活性。具体而言分为以下步骤&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;新建目录&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;如果没有独立的PGP钥匙串目录，新建并按推荐方式赋予权限&lt;sup class=&quot;footnote-reference&quot; id=&quot;fr-3-1&quot;&gt;&lt;a href=&quot;#fn-3&quot;&gt;[3]&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; mkdir&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -m&lt;&#x2F;span&gt;&lt;span&gt; 0755&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -p&lt;&#x2F;span&gt;&lt;span&gt; &#x2F;etc&#x2F;apt&#x2F;keyrings&#x2F;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;一般而言这个过程只对于 Debian 12 和 Ubuntu 22.04 之前的系统是必须的，使用者可以自行检查是否已经有该默认目录用来存放公钥。&lt;&#x2F;p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;下载公钥&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;从受信任来源下载 APT 仓库的公钥文件：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;wget -O- &lt;&#x2F;span&gt;&lt;span&gt;&amp;lt;https:&#x2F;&#x2F;example.com&#x2F;key&#x2F;repo-key.gpg&amp;gt; | &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;gpg --dearmor &lt;&#x2F;span&gt;&lt;span&gt;| &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; tee &#x2F;usr&#x2F;share&#x2F;keyrings&#x2F;&amp;lt;myrepository&amp;gt;-archive-keyring.gpg
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;解释其中的指令&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;wget&lt;&#x2F;code&gt; 从受信任来源 &lt;code&gt;https:&#x2F;&#x2F;example.com&#x2F;key&#x2F;repo-key.gpg&lt;&#x2F;code&gt; 下载公钥并输出至控制台 &lt;code&gt;stdout&lt;&#x2F;code&gt; （参数 &lt;code&gt;-O-&lt;&#x2F;code&gt;）。这里的 URL 应替换为你想要下载的公钥地址，比如docker&lt;&#x2F;li&gt;
&lt;li&gt;&lt;code&gt;gpg --dearmor&lt;&#x2F;code&gt; 使用 gpg 工具 unpack 符合 OpenPGP ASCII armor的公钥&lt;&#x2F;li&gt;
&lt;li&gt;&lt;code&gt;sudo tee &#x2F;usr&#x2F;share&#x2F;keyrings&#x2F;&amp;lt;myrepository&amp;gt;-archive-keyring.gpg&lt;&#x2F;code&gt; 以管理员身份（&lt;code&gt;&#x2F;usr&#x2F;share&#x2F;keyrings&lt;&#x2F;code&gt;目录只有root写权限），读取unpack后的公钥并将其写入该目录下的文件，&lt;code&gt;&amp;lt;myrepository&amp;gt;&lt;&#x2F;code&gt;应替换为描述公钥用途的名称，按照要求一般要包含被签名仓库名称。&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;也可以通过 &lt;code&gt;curl&lt;&#x2F;code&gt; 下载，并通过 &lt;code&gt;gpg&lt;&#x2F;code&gt; 的 &lt;code&gt;--output &amp;lt;file&amp;gt;&lt;&#x2F;code&gt; 或 &lt;code&gt;-o &amp;lt;file&amp;gt;&lt;&#x2F;code&gt;合并后两条命令指定输出目录：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;curl -fsSL &lt;&#x2F;span&gt;&lt;span&gt;&amp;lt;https:&#x2F;&#x2F;example.com&#x2F;key&#x2F;repo-key.gpg&amp;gt; | &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; gpg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --dearmor --output&lt;&#x2F;span&gt;&lt;span&gt; &#x2F;usr&#x2F;share&#x2F;keyrings&#x2F;&amp;lt;myrepository&amp;gt;-archive-keyring.gpg
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;编辑源&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;上述只是添加公钥，对于软件包管理工具我们需要进一步编辑软件源，指明其使用的是哪一个公钥并验证，以&lt;code&gt;apt&lt;&#x2F;code&gt;工具为例。如果手动添加源，应该在&lt;code&gt;&#x2F;etc&#x2F;apt&#x2F;sources.list.d&#x2F;&lt;&#x2F;code&gt;新建&lt;code&gt;.sources&lt;&#x2F;code&gt;文件，文件格式可使用单行格式（one-line format）或者使用更新的 DEB822 格式（DEB822 format）。以下是两种格式的示例：&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;单行格式（one-line format）：&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;pre data-lang=&quot;txt&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-txt &quot;&gt;&lt;code class=&quot;language-txt&quot; data-lang=&quot;txt&quot;&gt;&lt;span&gt;deb [signed-by=&#x2F;usr&#x2F;share&#x2F;keyrings&#x2F;&amp;lt;myrepository&amp;gt;-archive-keyring.gpg] https:&#x2F;&#x2F;example.com&#x2F;debian stable main
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;ul&gt;
&lt;li&gt;DEB822 格式（DEB822 format）：&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;pre data-lang=&quot;txt&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-txt &quot;&gt;&lt;code class=&quot;language-txt&quot; data-lang=&quot;txt&quot;&gt;&lt;span&gt;Types: deb
&lt;&#x2F;span&gt;&lt;span&gt;URIs: https:&#x2F;&#x2F;example.com&#x2F;debian
&lt;&#x2F;span&gt;&lt;span&gt;Suites: stable
&lt;&#x2F;span&gt;&lt;span&gt;Components: main
&lt;&#x2F;span&gt;&lt;span&gt;Signed-By: &#x2F;usr&#x2F;share&#x2F;keyrings&#x2F;&amp;lt;myrepository&amp;gt;-archive-keyring.gpg
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;code&gt;apt&lt;&#x2F;code&gt;（2.3.10）及更新版本还支持在&lt;code&gt;sources.list&lt;&#x2F;code&gt;中内嵌公钥&lt;sup class=&quot;footnote-reference&quot; id=&quot;fr-1-2&quot;&gt;&lt;a href=&quot;#fn-1&quot;&gt;[1]&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;。&lt;&#x2F;p&gt;
&lt;h3 id=&quot;macos-xi-tong&quot;&gt;macOS 系统&lt;&#x2F;h3&gt;
&lt;p&gt;在 macOS 上，Homebrew 使用 GPG 签名来验证软件包的完整性和来源。用户可以通过 Homebrew 安装 GPG 工具，并使用 GPG 密钥对软件包进行签名和验证。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;can-kao-zi-liao&quot;&gt;参考资料&lt;&#x2F;h2&gt;
&lt;hr&gt;&lt;ol class=&quot;footnotes-list&quot;&gt;
&lt;li id=&quot;fn-1&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;www.linuxuprising.com&#x2F;2021&#x2F;01&#x2F;apt-key-is-deprecated-how-to-add.html&quot;&gt;Warning: apt-key is deprecated. Manage keyring files in trusted.gpg.d instead&lt;&#x2F;a&gt; &lt;a href=&quot;#fr-1-1&quot;&gt;↩&lt;&#x2F;a&gt; &lt;a href=&quot;#fr-1-2&quot;&gt;↩2&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li id=&quot;fn-2&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;salsa.debian.org&#x2F;apt-team&#x2F;apt&#x2F;-&#x2F;raw&#x2F;2.9.24&#x2F;debian&#x2F;NEWS&quot;&gt;APT release news&lt;&#x2F;a&gt; &lt;a href=&quot;#fr-2-1&quot;&gt;↩&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li id=&quot;fn-3&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;wiki.debian.org&#x2F;DebianRepository&#x2F;UseThirdParty#OpenPGP_certificate_distribution&quot;&gt;Debian Wiki&lt;&#x2F;a&gt; &lt;a href=&quot;#fr-3-1&quot;&gt;↩&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Recommended Way to Manage Package Verification Keyrings on Linux and macOS</title>
        <published>2025-10-21T00:00:00+00:00</published>
        <updated>2025-10-21T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              edwardzcn-decade
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://www.edwardzcn.me/blog/programming/manage-package-keyrings-linux-macos/"/>
        <id>https://www.edwardzcn.me/blog/programming/manage-package-keyrings-linux-macos/</id>
        
        <content type="html" xml:base="https://www.edwardzcn.me/blog/programming/manage-package-keyrings-linux-macos/">&lt;h2 id=&quot;signed-package-and-verification-keys&quot;&gt;Signed Package and Verification Keys&lt;&#x2F;h2&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>ArmSom-Sige5开发版使用Armbian——Cockpit面板</title>
        <published>2025-01-27T00:00:00+00:00</published>
        <updated>2025-01-27T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              edwardzcn-decade
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://www.edwardzcn.me/blog/programming/armsom-sige5-armbian-cockpit/"/>
        <id>https://www.edwardzcn.me/blog/programming/armsom-sige5-armbian-cockpit/</id>
        
        <summary type="html">&lt;p&gt;接上一篇&lt;a href=&quot;https:&#x2F;&#x2F;www.edwardzcn.me&#x2F;blog&#x2F;programming&#x2F;armsom-sige5-armbian-cockpit&#x2F;.&#x2F;ArmSom-Sige5%E5%BC%80%E5%8F%91%E7%89%88%E4%BD%BF%E7%94%A8Armbian%E2%80%94%E2%80%94%E5%9F%BA%E7%A1%80%E8%B7%AF%E7%94%B1.md&quot;&gt;《ArmSom-Sige5开发版使用Armbian——基础路由》&lt;&#x2F;a&gt;，本文将介绍如何在 ArmSom-Sige5 开发板上安装 &lt;a href=&quot;https:&#x2F;&#x2F;cockpit-project.org&#x2F;&quot;&gt;Cockpit&lt;&#x2F;a&gt; Web GUI 作为管理面板，监视其他服务器（包括 Homelab设备 和 VPS）。&lt;&#x2F;p&gt;
</summary>
        
    </entry>
    <entry xml:lang="en">
        <title>ArmSom-Sige5开发版使用Armbian——基础路由</title>
        <published>2025-01-18T00:00:00+00:00</published>
        <updated>2025-01-18T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              edwardzcn-decade
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://www.edwardzcn.me/blog/programming/armsom-sige5-armbian-basic-router/"/>
        <id>https://www.edwardzcn.me/blog/programming/armsom-sige5-armbian-basic-router/</id>
        
        <content type="html" xml:base="https://www.edwardzcn.me/blog/programming/armsom-sige5-armbian-basic-router/">&lt;p&gt;记录过年回家前的一次折腾，把ArmSom-Sige5开发版&lt;del&gt;刷了社区版Armbian又降回板子厂商提供的unofficial Armbian&lt;&#x2F;del&gt;，配置软路由功能兼有Linux环境开发体验。&lt;&#x2F;p&gt;
&lt;p&gt;免责声明：初次接触开发版&lt;del&gt;我也忘记哪里看到ArmSom的广告就买了，可能我只是喜欢他家的💜紫色外壳&lt;&#x2F;del&gt;，不保证本文有参考价值，仅作为个人踩坑记录。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;https:&#x2F;&#x2F;eddyblog.oss-cn-shenzhen.aliyuncs.com&#x2F;2025-01-18&#x2F;armbian0.jpeg&quot; alt=&quot;sige5&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;h2 id=&quot;gu-jian-emmcshao-xie&quot;&gt;固件eMMC烧写&lt;&#x2F;h2&gt;
&lt;p&gt;因为手头没有可用的microSD卡，选择type-C数据线直连电脑和板子烧录固件到eMMC。具体步骤如下：&lt;&#x2F;p&gt;
&lt;h3 id=&quot;zhun-bei-gong-zuo&quot;&gt;准备工作&lt;&#x2F;h3&gt;
&lt;ul&gt;
&lt;li&gt;两根type-C线，一根用于开发版和电脑连接，一根为开发版供电。&lt;&#x2F;li&gt;
&lt;li&gt;准备 MiniLoader （ArmSom官方提供，sige5为RK3576_MiniLoaderAll）&lt;&#x2F;li&gt;
&lt;li&gt;准备 System Image
&lt;ul&gt;
&lt;li&gt;我使用的是ArmSom提供的unofficial Armbian镜像&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;armbian&#x2F;community&#x2F;releases&#x2F;&quot;&gt;Armbian Community 镜像&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;其他镜像请参考&lt;a href=&quot;https:&#x2F;&#x2F;docs.armsom.org&#x2F;zh&#x2F;armsom-sige5&quot;&gt;ArmSom Sige5文档&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;烧录工具
&lt;ul&gt;
&lt;li&gt;Windows 使用 RKDevTool（ArmSom官方提供）&lt;&#x2F;li&gt;
&lt;li&gt;Linux&#x2F;macOS 使用 &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;rockchip-linux&#x2F;rkdeveloptool&quot;&gt;rkdeveloptool&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h3 id=&quot;shao-lu-bu-zou&quot;&gt;烧录步骤&lt;&#x2F;h3&gt;
&lt;p&gt;进入 Maskrom 模式，参考&lt;a href=&quot;https:&#x2F;&#x2F;docs.armsom.org&#x2F;zh&#x2F;getting-start&#x2F;flash-img#232-usb%E7%BA%BF%E7%83%A7%E5%BD%95%E5%88%B0emmc&quot;&gt;镜像烧录步骤&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;断开所有供电电线，连接开发版和电脑&lt;&#x2F;li&gt;
&lt;li&gt;使用一根Type-C线连接开发版Type-C口（非供电接口）和电脑的usb接口，使用软件检测
&lt;ul&gt;
&lt;li&gt;Windows RKDevTool 下方显示 &lt;code&gt;No Devices Found&lt;&#x2F;code&gt;&lt;&#x2F;li&gt;
&lt;li&gt;Linux&#x2F;macOS 运行 &lt;code&gt;rkdevelotool ld&lt;&#x2F;code&gt; 显示 &lt;code&gt;not found any devices!&lt;&#x2F;code&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;按住Mashrom按键，使用另一根Type-C线连接开发版Type-C口（供电接口）和电源
&lt;ul&gt;
&lt;li&gt;Windows RKDevTool 下方显示 “Found One Loader Device”，可松开按键&lt;&#x2F;li&gt;
&lt;li&gt;Linux&#x2F;macOS 运行 &lt;code&gt;rkdevelotool ld&lt;&#x2F;code&gt; 检测到设备 &lt;code&gt;DevNo=1 Vid=0x2207,Pid=0x350e,LocationID=201    Maskrom&lt;&#x2F;code&gt;，可松开按键&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;根据下面的平台&#x2F;软件选择要烧录的 System Image 进行烧录&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;h4 id=&quot;windows-rkdevtool&quot;&gt;Windows RkDevTool&lt;&#x2F;h4&gt;
&lt;p&gt;&lt;img src=&quot;https:&#x2F;&#x2F;eddyblog.oss-cn-shenzhen.aliyuncs.com&#x2F;2025-01-18&#x2F;armbian1.png&quot; alt=&quot;RKDevTool&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;其中 Loader Path 为MiniLoader路径，Image Path 为所烧录镜像的路径。起始地址为 0x0000 无需修改，注意勾选 Write by Address，点击 Run 开始烧录。右侧Download image完成即烧录完成。&lt;&#x2F;p&gt;
&lt;h4 id=&quot;linux-macos-rkdeveloptool&quot;&gt;Linux&#x2F;macOS rkdeveloptool&lt;&#x2F;h4&gt;
&lt;p&gt;命令行执行&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;rkdeveloptool&lt;&#x2F;span&gt;&lt;span&gt; db RK3576_MiniLoaderAll.bin
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;rkdeveloptool&lt;&#x2F;span&gt;&lt;span&gt; wl 0x0000 Armbian_community_25.2.0-trunk.86_Armsom-sige5_noble_vendor_6.1.75_gnome_desktop.img
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;rkdeveloptool&lt;&#x2F;span&gt;&lt;span&gt; rd
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;等待烧录完成。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;armbian-chu-shi-pei-zhi&quot;&gt;Armbian 初始配置&lt;&#x2F;h2&gt;
&lt;p&gt;开发版接电，使用HDMI接口外接显示器，我烧录的是带有GNOME桌面环境的Armbian镜像，初次登录需要一些配置，还不能直接进入桌面系统。&lt;a href=&quot;https:&#x2F;&#x2F;docs.armbian.com&#x2F;User-Guide_Getting-Started&#x2F;&quot;&gt;Armbian 默认登录root密码为1234&lt;&#x2F;a&gt;。初始配置包含以下：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;txt&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-txt &quot;&gt;&lt;code class=&quot;language-txt&quot; data-lang=&quot;txt&quot;&gt;&lt;span&gt;Welcome to Armbian!
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;Documentation: https:&#x2F;&#x2F;docs.armbian.com&#x2F; | Community support: https:&#x2F;&#x2F;forum.armbian.com&#x2F;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;IP address:  Network connection timeout!
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;Create root password: ********
&lt;&#x2F;span&gt;&lt;span&gt;Repeat root password: ********
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;Shell: BASH
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;Please provide a username (eg. your first name): ?
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;Create user (Jane) password: ********
&lt;&#x2F;span&gt;&lt;span&gt;Repeat user (Jane) password: ********
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;...
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;完成配置后桌面系统会重启进入GNOME桌面，非桌面系统会新建 ssh 对话。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;armbian-xi-tong-huan-yuan&quot;&gt;Armbian 系统换源&lt;&#x2F;h2&gt;
&lt;p&gt;由于国内网络问题，进入系统首先更换镜像源&lt;sup class=&quot;footnote-reference&quot; id=&quot;fr-1-1&quot;&gt;&lt;a href=&quot;#fn-1&quot;&gt;[1]&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt; &lt;sup class=&quot;footnote-reference&quot; id=&quot;fr-2-1&quot;&gt;&lt;a href=&quot;#fn-2&quot;&gt;[2]&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;，Armbian是构建在Debian或Ubuntu发行版上，需要编辑：&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;&#x2F;etc&#x2F;apt&#x2F;sources.list&#x2F;armbian.list&lt;&#x2F;code&gt;armbian专属软件源和&lt;&#x2F;li&gt;
&lt;li&gt;&lt;code&gt;&#x2F;etc&#x2F;apt&#x2F;sources.list&lt;&#x2F;code&gt;发行版基础的软件源。&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h3 id=&quot;armbian-zhuan-shu-ruan-jian-yuan-huan-yuan&quot;&gt;Armbian 专属软件源换源&lt;&#x2F;h3&gt;
&lt;p&gt;可参考 &lt;a href=&quot;https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;help&#x2F;armbian&#x2F;&quot;&gt;TUNA Mirror Help&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;或者使用下面的镜像选择脚本&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#65737e;&quot;&gt;#!&#x2F;bin&#x2F;bash
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;GREEN&lt;&#x2F;span&gt;&lt;span&gt;=&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;\033[0;32m&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CYAN&lt;&#x2F;span&gt;&lt;span&gt;=&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;\033[0;36m&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;RED&lt;&#x2F;span&gt;&lt;span&gt;=&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;\033[0;31m&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span&gt;=&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;\033[0m&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;SOURCE_FILE&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&#x2F;etc&#x2F;apt&#x2F;sources.list.d&#x2F;armbian.list&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CURRENT_SOURCE&lt;&#x2F;span&gt;&lt;span&gt;=$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;grep -Eo &lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;https?:&#x2F;&#x2F;[^ ]+&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39; &amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;SOURCE_FILE&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; | &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;head -n&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt; 1)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;[[ &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CURRENT_SOURCE&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; == *&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;tuna.tsinghua.edu.cn&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;* &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;]]&lt;&#x2F;span&gt;&lt;span&gt;; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;then
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CURRENT_SOURCE_NAME&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Tsinghua 清华大学镜像源&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;elif &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;[[ &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CURRENT_SOURCE&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; == *&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;ustc.edu.cn&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;* &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;]]&lt;&#x2F;span&gt;&lt;span&gt;; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;then
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CURRENT_SOURCE_NAME&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;USTC 中国科学技术大学镜像源&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;elif &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;[[ &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CURRENT_SOURCE&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; == *&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;apt.armbian.com&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;* &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;]]&lt;&#x2F;span&gt;&lt;span&gt;; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;then
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CURRENT_SOURCE_NAME&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;官方镜像源&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;else
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CURRENT_SOURCE_NAME&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;未知镜像源&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;fi
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CYAN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}======================================&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CYAN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}   Armbian Mirror Switcher Script    &lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CYAN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}======================================&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;[ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-n &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CURRENT_SOURCE&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;]&lt;&#x2F;span&gt;&lt;span&gt;; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;then
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;GREEN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}当前源：&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CURRENT_SOURCE&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;GREEN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}镜像源名称：&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CURRENT_SOURCE_NAME&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;else
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;RED&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}未检测到有效的源配置！&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;fi
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;GREEN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}请选择要切换的镜像源:&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;1. Tsinghua 清华大学源 (https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn)&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;2. USTC 中国科学技术大学源 (https:&#x2F;&#x2F;mirrors.ustc.edu.cn)&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;3. 恢复为默认的官方源 (http:&#x2F;&#x2F;apt.armbian.com)&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-ne &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CYAN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}请输入选项 (1, 2 或 3): &lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;read &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-r&lt;&#x2F;span&gt;&lt;span&gt; choice
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;case &lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;choice &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;in
&lt;&#x2F;span&gt;&lt;span&gt;    1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;GREEN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}切换到 Tsinghua 源...&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; sed&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -i&lt;&#x2F;span&gt;&lt;span&gt;.bak&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -E &lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;s#https?:&#x2F;&#x2F;(mirrors\.(tuna\.tsinghua\.edu\.cn|ustc\.edu\.cn)|apt\.armbian\.com)#https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn#g&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39; &amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;SOURCE_FILE&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;GREEN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}源已成功更换为 Tsinghua 清华大学镜像！&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;        ;;
&lt;&#x2F;span&gt;&lt;span&gt;    2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;GREEN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}切换到 USTC 源...&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; sed&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -i&lt;&#x2F;span&gt;&lt;span&gt;.bak&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -E &lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;s#https?:&#x2F;&#x2F;(mirrors\.(tuna\.tsinghua\.edu\.cn|ustc\.edu\.cn)|apt\.armbian\.com)#https:&#x2F;&#x2F;mirrors.ustc.edu.cn#g&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39; &amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;SOURCE_FILE&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;GREEN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}源已成功更换为 USTC 中国科学技术大学镜像！&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;        ;;
&lt;&#x2F;span&gt;&lt;span&gt;    3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;GREEN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}恢复为默认的官方源...&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; sed&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -i&lt;&#x2F;span&gt;&lt;span&gt;.bak&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -E &lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;s#https?:&#x2F;&#x2F;(mirrors\.(tuna\.tsinghua\.edu\.cn|ustc\.edu\.cn)|apt\.armbian\.com)#http:&#x2F;&#x2F;apt.armbian.com#g&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39; &amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;SOURCE_FILE&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;GREEN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}源已恢复为默认的官方镜像！&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;        ;;
&lt;&#x2F;span&gt;&lt;span&gt;    *&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;RED&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}无效输入！请重新运行脚本并选择 1, 2 或 3。&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;exit&lt;&#x2F;span&gt;&lt;span&gt; 1
&lt;&#x2F;span&gt;&lt;span&gt;        ;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;esac
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-ne &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CYAN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}是否立即更新软件包索引？(y&#x2F;n): &lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;read &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-r&lt;&#x2F;span&gt;&lt;span&gt; update_choice
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;[[ &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;update_choice&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; =~ ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;[&lt;&#x2F;span&gt;&lt;span&gt;Yy&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;]&lt;&#x2F;span&gt;&lt;span&gt;$ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;]]&lt;&#x2F;span&gt;&lt;span&gt;; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;then
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CYAN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}更新软件包索引...&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; apt-get update
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;GREEN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}软件包索引更新完成！&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;else
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CYAN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}已跳过更新软件包索引。&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;fi
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-e &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;GREEN&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}镜像源切换操作完成！&lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NC&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;fa-xing-ban-ji-chu-debian-ubuntu-huan-yuan&quot;&gt;发行版基础Debian&#x2F;Ubuntu 换源&lt;&#x2F;h3&gt;
&lt;p&gt;根据登录开发版 motd 信息获取确定发行版基础&lt;sup class=&quot;footnote-reference&quot; id=&quot;fr-2-2&quot;&gt;&lt;a href=&quot;#fn-2&quot;&gt;[2]&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;，比如我的显示如下：&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;https:&#x2F;&#x2F;eddyblog.oss-cn-shenzhen.aliyuncs.com&#x2F;2025-01-18&#x2F;armbian2.png&quot; alt=&quot;motd&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;Noble 表示基于 Ubuntu 24.04 (noble)&lt;&#x2F;p&gt;
&lt;p&gt;或者可以使用&lt;code&gt;cat &#x2F;etc&#x2F;os-release&lt;&#x2F;code&gt;获取详细系统信息&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;edwardzcn@armsom-sige5:~$&lt;&#x2F;span&gt;&lt;span&gt; cat &#x2F;etc&#x2F;os-release
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;PRETTY_NAME&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Armbian 24.11.3 noble&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;NAME&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Ubuntu&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;VERSION_ID&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;24.04&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;VERSION&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;24.04 LTS (Noble Numbat)&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;VERSION_CODENAME&lt;&#x2F;span&gt;&lt;span&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;noble
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;ID&lt;&#x2F;span&gt;&lt;span&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;ubuntu
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;ID_LIKE&lt;&#x2F;span&gt;&lt;span&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;debian
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;HOME_URL&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;https:&#x2F;&#x2F;www.armbian.com&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;SUPPORT_URL&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;https:&#x2F;&#x2F;forum.armbian.com&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;BUG_REPORT_URL&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;https:&#x2F;&#x2F;www.armbian.com&#x2F;bugs&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;PRIVACY_POLICY_URL&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;https:&#x2F;&#x2F;www.armbian.com&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;UBUNTU_CODENAME&lt;&#x2F;span&gt;&lt;span&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;noble
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;LOGO&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;armbian-logo&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;ARMBIAN_PRETTY_NAME&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Armbian 24.11.3 noble&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;确定是ubuntu还是debian就可以选择镜像源，以清华源为例&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;清华大学Debian源 https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;help&#x2F;debian&lt;&#x2F;li&gt;
&lt;li&gt;清华大学Ubuntu Ports源 https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;help&#x2F;ubuntu-ports&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;注意Ubuntu系要选择ubuntu-port源，换源可参考 &lt;a href=&quot;https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;help&#x2F;ubuntu-ports&#x2F;&quot;&gt;TUNA Mirror help&lt;&#x2F;a&gt; 或者 &lt;a href=&quot;https:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;help&#x2F;ubuntu-ports.html&quot;&gt;USTC Mirror Help&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;还是以使用清华源为例，手动修改&lt;code&gt;&#x2F;etc&#x2F;apt&#x2F;sources.list&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; nano &#x2F;etc&#x2F;apt&#x2F;sources.list
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;txt&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-txt &quot;&gt;&lt;code class=&quot;language-txt&quot; data-lang=&quot;txt&quot;&gt;&lt;span&gt;deb https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;ubuntu-ports&#x2F; noble main restricted universe multiverse
&lt;&#x2F;span&gt;&lt;span&gt;# deb-src https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;ubuntu-ports&#x2F; noble main restricted universe multiverse
&lt;&#x2F;span&gt;&lt;span&gt;deb https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;ubuntu-ports&#x2F; noble-updates main restricted universe multiverse
&lt;&#x2F;span&gt;&lt;span&gt;# deb-src https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;ubuntu-ports&#x2F; noble-updates main restricted universe multiverse
&lt;&#x2F;span&gt;&lt;span&gt;deb https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;ubuntu-ports&#x2F; noble-backports main restricted universe multiverse
&lt;&#x2F;span&gt;&lt;span&gt;# deb-src https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;ubuntu-ports&#x2F; noble-backports main restricted universe multiverse
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;现在你&lt;del&gt;不用看着10+Kbps的网速干着急&lt;&#x2F;del&gt;可放心使用&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; apt update
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; apt upgrade
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;瞧瞧你的板子，说实话ASCII画我还是喜欢原来那个大A。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; apt install neofetch&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -y &lt;&#x2F;span&gt;&lt;span&gt;&amp;amp;&amp;amp; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;neofetch
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;img src=&quot;https:&#x2F;&#x2F;eddyblog.oss-cn-shenzhen.aliyuncs.com&#x2F;2025-01-18&#x2F;armbian3.png&quot; alt=&quot;neofetch&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;h3 id=&quot;jing-tai-ip-ssh-diao-shi&quot;&gt;静态 IP + ssh 调试&lt;&#x2F;h3&gt;
&lt;p&gt;我更习惯使用我的工作机（一台mac）通过网线连接板子，使用 ssh 做基础路由设置以及一些软件更新，桌面系统开始会有卡顿（以及无浏览器等问题）&lt;&#x2F;p&gt;
&lt;p&gt;插入网线后，假定工作机以太网接口连接开发版eth1接口&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;在工作机上设置网络-以太网&lt;code&gt;手动&lt;&#x2F;code&gt;配置IPv4，IP地址 &lt;code&gt;192.168.1.100&lt;&#x2F;code&gt;，子网掩码 &lt;code&gt;255.255.255.0&lt;&#x2F;code&gt;&lt;&#x2F;li&gt;
&lt;li&gt;在开发版上设置网络 手动（Manual）IPv4（取消掉自动DHCP），IP地址 &lt;code&gt;192.168.1.1&lt;&#x2F;code&gt;（常见路由器地址），子网掩码 &lt;code&gt;255.255.255.0&lt;&#x2F;code&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;&lt;code&gt;ping&lt;&#x2F;code&gt;测试是否可以连通，确定ICMP可用，然后使用 Armbian初始配置中 设置的用户密码（桌面系统建议连接非root用户）&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#65737e;&quot;&gt;# 工作机 ping 开发板
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;zmac-mini:~:&lt;&#x2F;span&gt;&lt;span&gt;% ping&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -c&lt;&#x2F;span&gt;&lt;span&gt; 5 192.168.1.1
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;PING&lt;&#x2F;span&gt;&lt;span&gt; 192.168.1.1 (192.168.1.1)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span&gt; 56 data bytes
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;64&lt;&#x2F;span&gt;&lt;span&gt; bytes from 192.168.1.1: icmp_seq=0 ttl=64 time=0.918 ms
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;64&lt;&#x2F;span&gt;&lt;span&gt; bytes from 192.168.1.1: icmp_seq=1 ttl=64 time=0.885 ms
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;64&lt;&#x2F;span&gt;&lt;span&gt; bytes from 192.168.1.1: icmp_seq=2 ttl=64 time=0.818 ms
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;64&lt;&#x2F;span&gt;&lt;span&gt; bytes from 192.168.1.1: icmp_seq=3 ttl=64 time=0.773 ms
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;64&lt;&#x2F;span&gt;&lt;span&gt; bytes from 192.168.1.1: icmp_seq=4 ttl=64 time=0.867 ms
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;---&lt;&#x2F;span&gt;&lt;span&gt; 192.168.1.1 ping statistics ---
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;5&lt;&#x2F;span&gt;&lt;span&gt; packets transmitted, 5 packets received, 0.0% packet loss
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;round-trip&lt;&#x2F;span&gt;&lt;span&gt; min&#x2F;avg&#x2F;max&#x2F;stddev = 0.773&#x2F;0.852&#x2F;0.918&#x2F;0.051 ms
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;使用 ssh 密码登录，后续 Armbian开发板 ssh 登录配置类似于 VPS 远程 ssh 登录配置&lt;sup class=&quot;footnote-reference&quot; id=&quot;fr-3-1&quot;&gt;&lt;a href=&quot;#fn-3&quot;&gt;[3]&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;，可根据自己习惯和需求配置密钥登录等。&lt;&#x2F;p&gt;
&lt;h3 id=&quot;diao-zheng-dian-yuan-ji-hua-he-xiu-mian-she-zhi&quot;&gt;调整电源计划和休眠设置&lt;&#x2F;h3&gt;
&lt;p&gt;有些时候可能 ssh连接一段时间会遇到系统被挂起（suspend）的提示，方便起见还是关掉GNOME电源选项的 Automatic Suspend，&lt;del&gt;我并不确定是因为这个挂起的，因为suspend的日志没看懂也没找到命令行设置方式&lt;&#x2F;del&gt;。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;https:&#x2F;&#x2F;eddyblog.oss-cn-shenzhen.aliyuncs.com&#x2F;2025-01-18&#x2F;armbian4.png&quot; alt=&quot;suspend&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;h2 id=&quot;armbian-ji-chu-lu-you&quot;&gt;Armbian 基础路由&lt;&#x2F;h2&gt;
&lt;p&gt;好的似乎终于进入正题了，先说说为什么突然想着折腾小板子，以及为什么选择了 Armbian，我先放几个理由，有想到再补充&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;兼顾软路由，但又不想要openwrt&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;ul&gt;
&lt;li&gt;openwrt固然很方便，但有两个点为人诟病：包管理问题、为照顾大量低性能的设备做了兼容（但事实上，你并不一定会用这些IoT设备对吗？）。Armbian 基于Ubuntu或者Debian给了更多玩法，特别是对有Linux使用经验的玩家&#x2F;开发者，可以使用apt包管理工具，充分利用这一价位开发版的价值（比如利用板载npu做一点推理，毕竟都自称mini computer了）&lt;&#x2F;li&gt;
&lt;li&gt;套壳&#x2F;层叠的软件栈带来很多负担。个人便好，不喜欢docker虚拟机套壳最后只部署一个软路由。&lt;&#x2F;li&gt;
&lt;li&gt;另外有技术佬说&lt;del&gt;openwrt 很灵车但我没遇到过&lt;&#x2F;del&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;Use Armbian just like Ubuntu+&#x2F;Debian+&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;ul&gt;
&lt;li&gt;虽然没有openwrt或者硬路由提供的面板，&lt;code&gt;armbian-config&lt;&#x2F;code&gt;基本上覆盖了应有的便捷配置（如果你喜欢这种 CLI 交互就更适合了），&lt;del&gt;不过你现在还用不了，&lt;code&gt;armbian-config&lt;&#x2F;code&gt;需建立和github.com的通信&lt;&#x2F;del&gt;&lt;&#x2F;li&gt;
&lt;li&gt;恰有基于arm镜像的服务需要跑&lt;&#x2F;li&gt;
&lt;li&gt;剩余的性能释放出来跑我的脚本和检测🐤面板&lt;&#x2F;li&gt;
&lt;li&gt;&lt;del&gt;出来吧 NAS&lt;&#x2F;del&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;本节先更新基础的路由部分，以及对桌面环境的必要调整&lt;&#x2F;p&gt;
&lt;p&gt;其实一个基本的（软）路由器系统主要包括下面几项服务，开箱即用的面板或者一键式脚本只是简化帮助完成这些配置&lt;sup class=&quot;footnote-reference&quot; id=&quot;fr-1-2&quot;&gt;&lt;a href=&quot;#fn-1&quot;&gt;[1]&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;。&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;DNS&lt;&#x2F;strong&gt;：域名解析服务，用于将主机名称（局域网主机名，域名解析）解析为IP地址
&lt;ul&gt;
&lt;li&gt;可以当作：&lt;strong&gt;小区户名-门牌号查询簿&lt;&#x2F;strong&gt;&lt;&#x2F;li&gt;
&lt;li&gt;请注意：公网上提供DNS服务是被禁止的，会被封IP，该项服务只允许运营商提供&lt;&#x2F;li&gt;
&lt;li&gt;由于传统DNS查询是明文，可以被中间人截留修改造成DNS污染，需要适当调整，比如使用DoH和DoT分流。&lt;&#x2F;li&gt;
&lt;li&gt;可用工具 systemd-resolved，TelescopeDNS，EasyMosdns和dnsmasq&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;&lt;strong&gt;DHCP&lt;&#x2F;strong&gt;：动态IP地址分配协议（服务器）。终端网络设备一般会装载DHCP客户端（client）来自动请求并获取动态ip。（软）路由器系统的DHCP这里实际上是指DHCP服务器（server），用来分发管理局域网的ip地址，回应DHCP客户端发来的请求。
&lt;ul&gt;
&lt;li&gt;可以当作：&lt;strong&gt;小区住户门牌号地址簿（搬家会更新）&lt;&#x2F;strong&gt;&lt;&#x2F;li&gt;
&lt;li&gt;可用工具  coredhcp（yaml配置）&#x2F; dnsmasq（conf配置）&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;&lt;strong&gt;NAT&lt;&#x2F;strong&gt;：网络地址转换，建立局域网&lt;code&gt;&amp;lt;IP,Port&amp;gt;&lt;&#x2F;code&gt;元组与外网&lt;code&gt;&amp;lt;IP,Port&amp;gt;&lt;&#x2F;code&gt;映射，并进行转换。
&lt;ul&gt;
&lt;li&gt;可以当作：&lt;strong&gt;小区特派巴士座位表（巴士是和城市沟通的交通方式）&lt;&#x2F;strong&gt;&lt;&#x2F;li&gt;
&lt;li&gt;可用工具 iptables，nftables&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;&lt;strong&gt;IP Forwarding&lt;&#x2F;strong&gt;：IP转发，只有启用后才会将开发版某个接口（比如连接局域网设备）不经本地程序转发至外网接口。作为操作系统内核功能，用于支持多网卡设备在不同接口间的通信。
&lt;ul&gt;
&lt;li&gt;可以当作：&lt;strong&gt;手拿座位表的特派巴士司机&#x2F;售票员&lt;&#x2F;strong&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;在基础路由中我都挑选配置尽量简单，易兼容的工具。&lt;&#x2F;p&gt;
&lt;h3 id=&quot;wang-luo-lian-jie-guan-li&quot;&gt;网络连接管理&lt;&#x2F;h3&gt;
&lt;p&gt;Linux的网络连接管理可以使用 &lt;code&gt;systemd-networkd&lt;&#x2F;code&gt; 或 &lt;code&gt;NetworkManager&lt;&#x2F;code&gt; 。我搭建的基于Ubuntu的Armbian习惯用后者，还提供了更高层次的抽象&lt;code&gt;netplan&lt;&#x2F;code&gt;。理解成网络计划，简化编写，完成后可以自动渲染成&lt;code&gt;NetworkManager&lt;&#x2F;code&gt;描述。&lt;&#x2F;p&gt;
&lt;p&gt;修改&lt;code&gt;netplan&lt;&#x2F;code&gt;配置文件，默认在&lt;code&gt;&#x2F;etc&#x2F;netplan&#x2F;&lt;&#x2F;code&gt;目录，序号大的覆盖小的，为避免冲突，合并用一个文件描述，名字设为&lt;code&gt;00-default-use-network-manager.yaml&lt;&#x2F;code&gt;。如果你看到了其他以UUID命名的文件，则是通过GUI界面生成的配置，可以删除。&lt;&#x2F;p&gt;
&lt;p&gt;未经修改的文件类似：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;yaml&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-yaml &quot;&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;network&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;version&lt;&#x2F;span&gt;&lt;span&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;2
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;renderer&lt;&#x2F;span&gt;&lt;span&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;NetworkManager
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;修改后：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;yaml&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-yaml &quot;&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;network&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;version&lt;&#x2F;span&gt;&lt;span&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;2
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;renderer&lt;&#x2F;span&gt;&lt;span&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;NetworkManager
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;ethernets&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;eth1&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;dhcp4&lt;&#x2F;span&gt;&lt;span&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;false
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;addresses&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;        - &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;192.168.1.1&#x2F;24
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;nameservers&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;addresses&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;          - &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;192.168.1.1
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;执行&lt;code&gt;sudo netplan apply&lt;&#x2F;code&gt;使改变生效。可以在 GNOME 桌面的网络配置 GUI 中看到改变生效（名称暴露了是谁修改的）：&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;https:&#x2F;&#x2F;eddyblog.oss-cn-shenzhen.aliyuncs.com&#x2F;2025-01-18&#x2F;armbian5.png&quot; alt=&quot;netplan0&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;https:&#x2F;&#x2F;eddyblog.oss-cn-shenzhen.aliyuncs.com&#x2F;2025-01-18&#x2F;armbian6.png&quot; alt=&quot;netplan1&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;h3 id=&quot;dns-he-dhcp-pei-zhi&quot;&gt;DNS 和 DHCP 配置&lt;&#x2F;h3&gt;
&lt;p&gt;Armbian 默认使用 NetworkManager 中的 systemd-resolved组件，这个 DNSstub 监听 &lt;code&gt;127.0.0.53&lt;&#x2F;code&gt; 上的 &lt;code&gt;53&lt;&#x2F;code&gt;端口，其仅能监听本机请求而不能接受局域网内其他机器的请求，当路由肯定是不够的，安装并使用 &lt;code&gt;dnsmasq&lt;&#x2F;code&gt;作为DNS服务器，同时它也是一个轻量级的DHCP服务器，配置文件默认在&lt;code&gt;&#x2F;etc&#x2F;dnsmasq.conf&lt;&#x2F;code&gt;&lt;sup class=&quot;footnote-reference&quot; id=&quot;fr-4-1&quot;&gt;&lt;a href=&quot;#fn-4&quot;&gt;[4]&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; apt install dnsmasq
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; vim &#x2F;etc&#x2F;dnsmasq.conf
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;dnsmasq默认配置注释，初看很吓人，但实际上我们需要让路由跑起来并不需要调整很多，大多数配置看注释就能明白。这里给出我的最小化配置（还是假定开发版的eth1接口连接局域网设备）&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;txt&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-txt &quot;&gt;&lt;code class=&quot;language-txt&quot; data-lang=&quot;txt&quot;&gt;&lt;span&gt;port=0                                      # 关闭 DNS
&lt;&#x2F;span&gt;&lt;span&gt;server=1.1.1.1                              # 指明上游 DNS服务器
&lt;&#x2F;span&gt;&lt;span&gt;interface=eth1                              # 指定 DHCP 服务绑定的网络接口
&lt;&#x2F;span&gt;&lt;span&gt;bind-interfaces                             # 只监听对应接口的请求（即eth1 接口的地址）
&lt;&#x2F;span&gt;&lt;span&gt;dhcp-range=192.168.1.100,192.168.1.200,12h  # 分配 IP 地址范围（这里分配100-200）
&lt;&#x2F;span&gt;&lt;span&gt;dhcp-option=option:router,192.168.1.1       # 指定使用本网关 （默认网关）
&lt;&#x2F;span&gt;&lt;span&gt;dhcp-option=option:dns-server,192.168.1.1   # 指定使用本路由器 DNS
&lt;&#x2F;span&gt;&lt;span&gt;log-queries
&lt;&#x2F;span&gt;&lt;span&gt;log-dhcp
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;code&gt;bind-interfaces&lt;&#x2F;code&gt; 设置使&lt;code&gt;dnsmasq&lt;&#x2F;code&gt;只监听对应接口请求，而非监听0.0.0.0所有可用地址，用于兼容正在运行的 &lt;code&gt;systemd-resolved&lt;&#x2F;code&gt; （监听127.0.0.53的53端口），防止冲突。&lt;code&gt;port=0&lt;&#x2F;code&gt;配置也会禁用掉监听DNS请求的服务，也可以避免冲突（目前我们暂不使用 dnsmasq 的 DNS 服务）。&lt;code&gt;dhcp-option&lt;&#x2F;code&gt;开头的设置都和DHCP协议中option段有关，上述两条会让client端自动配置网关和DNS为当前配置路由器的地址。&lt;&#x2F;p&gt;
&lt;p&gt;如果不打算兼容&lt;code&gt;systemd-resolved&lt;&#x2F;code&gt;，我们需要调整&lt;code&gt;&#x2F;etc&#x2F;resolv.conf&lt;&#x2F;code&gt;并停止&lt;code&gt;systemd-resolved&lt;&#x2F;code&gt;服务，这里我们暂不考虑，优先让路由器跑起来。&lt;&#x2F;p&gt;
&lt;p&gt;重启 &lt;code&gt;dnsmasq&lt;&#x2F;code&gt; 服务，查看状态&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; systemctl restart dnsmasq.service
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; systemctl status dnsmasq.service
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;服务Active，&lt;del&gt;请先忽略那条Fail&lt;&#x2F;del&gt;，现在可以修改你工作机的网络设置，调整为DHCP（动态获取IP地址），效果如下：&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;https:&#x2F;&#x2F;eddyblog.oss-cn-shenzhen.aliyuncs.com&#x2F;2025-01-18&#x2F;armbian7.png&quot; alt=&quot;dhcp&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;h3 id=&quot;nat-he-ip-forwarding&quot;&gt;NAT 和 IP Forwarding&lt;&#x2F;h3&gt;
&lt;p&gt;虽然客户机能拿到ip地址，但我们还不能访问外网。此时开发版并不会将数据包从eth1（内网接口）递送至eth0（外网接口），也不知道内网地址和外网地址的翻译规则。&lt;&#x2F;p&gt;
&lt;p&gt;IP Forwarding 是 NAT 实现的基础，它负责将数据包在不同接口之间转发，而NAT更像是定义规则怎么修改为内网&#x2F;外网地址，两者搭配食用味道更佳。&lt;&#x2F;p&gt;
&lt;h4 id=&quot;qi-yong-ip-zhuan-fa&quot;&gt;启用 IP 转发&lt;&#x2F;h4&gt;
&lt;p&gt;编辑&lt;code&gt;&#x2F;etc&#x2F;systl.conf&lt;&#x2F;code&gt;：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; vim &#x2F;etc&#x2F;sysctl.conf
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;找到对应行取消注释，开启ipv4和ipv6转发。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;txt&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-txt &quot;&gt;&lt;code class=&quot;language-txt&quot; data-lang=&quot;txt&quot;&gt;&lt;span&gt;# Uncomment the next line to enable packet forwarding for IPv4
&lt;&#x2F;span&gt;&lt;span&gt;net.ipv4.ip_forward=1
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;# Uncomment the next line to enable packet forwarding for IPv6
&lt;&#x2F;span&gt;&lt;span&gt;#  Enabling this option disables Stateless Address Autoconfiguration
&lt;&#x2F;span&gt;&lt;span&gt;#  based on Router Advertisements for this host
&lt;&#x2F;span&gt;&lt;span&gt;net.ipv6.conf.all.forwarding=1
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;运行&lt;code&gt;sudo sysctl -p&lt;&#x2F;code&gt;使改变生效。&lt;&#x2F;p&gt;
&lt;h4 id=&quot;pei-zhi-iptables-jin-xing-nat&quot;&gt;配置 iptables 进行 NAT&lt;&#x2F;h4&gt;
&lt;p&gt;在我的实验环境中，外网接口为 &lt;code&gt;eth0&lt;&#x2F;code&gt;，内网接口为 &lt;code&gt;eth1&lt;&#x2F;code&gt;：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; iptables&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -t&lt;&#x2F;span&gt;&lt;span&gt; nat&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -A&lt;&#x2F;span&gt;&lt;span&gt; POSTROUTING&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -o&lt;&#x2F;span&gt;&lt;span&gt; eth0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -j&lt;&#x2F;span&gt;&lt;span&gt; MASQUERADE
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; iptables&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -A&lt;&#x2F;span&gt;&lt;span&gt; FORWARD&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -i&lt;&#x2F;span&gt;&lt;span&gt; eth1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -o&lt;&#x2F;span&gt;&lt;span&gt; eth0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -m&lt;&#x2F;span&gt;&lt;span&gt; state&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --state&lt;&#x2F;span&gt;&lt;span&gt; RELATED,ESTABLISHED&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -j&lt;&#x2F;span&gt;&lt;span&gt; ACCEPT
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sudo&lt;&#x2F;span&gt;&lt;span&gt; iptables&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -A&lt;&#x2F;span&gt;&lt;span&gt; FORWARD&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -i&lt;&#x2F;span&gt;&lt;span&gt; eth1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -o&lt;&#x2F;span&gt;&lt;span&gt; eth0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -j&lt;&#x2F;span&gt;&lt;span&gt; ACCEPT
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;保存规则：&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2b303b;color:#c0c5ce;&quot;&gt;&lt;code&gt;&lt;span&gt;sudo apt-get install iptables-persistent
&lt;&#x2F;span&gt;&lt;span&gt;sudo netfilter-persistent save
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;由于iptables规则默认只在当前会话生效。一旦系统重启或者服务重启规则会被清空，借助&lt;code&gt;iptables-persistent&lt;&#x2F;code&gt;持久化规则到文件中，每次系统或服务启动时自动加载。&lt;&#x2F;p&gt;
&lt;p&gt;基本路由配置 Done！现在可以试试用工作机通过板子访问外部网络了。&lt;&#x2F;p&gt;
&lt;hr&gt;&lt;ol class=&quot;footnotes-list&quot;&gt;
&lt;li id=&quot;fn-1&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;cyp0633.icu&#x2F;post&#x2F;armbian-r2s&#x2F;&quot;&gt;Armbian，更适合 R2S 软路由的系统&lt;&#x2F;a&gt; &lt;a href=&quot;#fr-1-1&quot;&gt;↩&lt;&#x2F;a&gt; &lt;a href=&quot;#fr-1-2&quot;&gt;↩2&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li id=&quot;fn-2&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;xiau.net&#x2F;990.html&#x2F;&quot;&gt;夏的博客 | Armbian换源教程&lt;&#x2F;a&gt;. &lt;a href=&quot;#fr-2-1&quot;&gt;↩&lt;&#x2F;a&gt; &lt;a href=&quot;#fr-2-2&quot;&gt;↩2&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li id=&quot;fn-3&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;linux.do&#x2F;t&#x2F;topic&#x2F;267502#p-2476630-h-9&quot;&gt;VPS基本安全措施 - 开发调优 - LINUX DO&lt;&#x2F;a&gt; &lt;a href=&quot;#fr-3-1&quot;&gt;↩&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li id=&quot;fn-4&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;docs.redhat.com&#x2F;en&#x2F;documentation&#x2F;red_hat_enterprise_linux&#x2F;9&#x2F;html&#x2F;configuring_and_managing_networking&#x2F;using-different-dns-servers-for-different-domains_configuring-and-managing-networking#using-systemd-resolved-in-networkmanager-to-send-dns-requests-for-a-specific-domain-to-a-selected-dns-server_using-different-dns-servers-for-different-domains&quot;&gt;RHEL 9 | systemd-resolved 使用&lt;&#x2F;a&gt; &lt;a href=&quot;#fr-4-1&quot;&gt;↩&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>VSCode使用跳板机远程登陆共享内网访问</title>
        <published>2021-05-14T00:00:00+00:00</published>
        <updated>2021-05-14T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              edwardzcn-decade
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://www.edwardzcn.me/blog/programming/vscode-remote-ssh-proxyjump/"/>
        <id>https://www.edwardzcn.me/blog/programming/vscode-remote-ssh-proxyjump/</id>
        
        <summary type="html">&lt;p&gt;2025-01 记录：古早的VSCode使用说明。并不能叫做内网穿透，遂改名为内网访问。&lt;&#x2F;p&gt;
</summary>
        
    </entry>
</feed>
